<!DOCTYPE html>
<html>
<head>
    <title>API Test</title>
    <style>
        body { font-family: Arial; padding: 30px; background: #f5f5f5; }
        .box { background: white; padding: 20px; border-radius: 10px; margin: 10px 0; }
        button { padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 5px; cursor: pointer; margin: 5px; }
        .success { background: #e8f5e9; padding: 15px; border-radius: 5px; }
        .error { background: #ffebee; padding: 15px; border-radius: 5px; color: #c62828; }
        pre { background: #f9f9f9; padding: 10px; border-radius: 5px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>üîç API Test</h1>
    
    <div class="box">
        <h2>Test 1: Check API is accessible</h2>
        <button onclick="testBasicAPI()">Test GET /api</button>
        <div id="test1-result"></div>
    </div>
    
    <div class="box">
        <h2>Test 2: Check phone endpoint</h2>
        <input type="text" id="testPhone" value="5324417909" placeholder="Phone number (10 digits)" />
        <button onclick="testCheckPhone()">Test check-phone</button>
        <div id="test2-result"></div>
    </div>

    <script>
        const API_BASE_URL = window.location.origin + '/api';
        
        function showResult(elementId, success, data) {
            const el = document.getElementById(elementId);
            const className = success ? 'success' : 'error';
            el.innerHTML = `<div class="${className}"><pre>${JSON.stringify(data, null, 2)}</pre></div>`;
        }
        
        async function testBasicAPI() {
            try {
                console.log('Testing basic API access to:', window.location.origin);
                const response = await fetch(window.location.origin + '/api/auth/check-phone', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ phone: '0000000000' })
                });
                
                console.log('Response status:', response.status);
                const data = await response.json();
                console.log('Response:', data);
                
                showResult('test1-result', response.ok, {
                    status: response.status,
                    message: response.ok ? '‚úÖ API is accessible' : '‚ùå API returned error',
                    response: data
                });
            } catch (error) {
                console.error('Error:', error);
                showResult('test1-result', false, {
                    error: error.message,
                    message: '‚ùå Cannot reach API'
                });
            }
        }
        
        async function testCheckPhone() {
            const phone = document.getElementById('testPhone').value.replace(/\D/g, '');
            
            if (phone.length !== 10) {
                showResult('test2-result', false, { error: 'Phone must be 10 digits' });
                return;
            }
            
            try {
                console.log('Testing check-phone with:', phone);
                const url = `${API_BASE_URL}/auth/check-phone`;
                console.log('URL:', url);
                
                const response = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ phone: phone })
                });
                
                console.log('Response status:', response.status);
                const data = await response.json();
                console.log('Response:', data);
                
                showResult('test2-result', response.ok, {
                    status: response.status,
                    phone: phone,
                    response: data
                });
            } catch (error) {
                console.error('Error:', error);
                showResult('test2-result', false, {
                    error: error.message,
                    phone: phone
                });
            }
        }
        
        // Test on page load
        setTimeout(() => testBasicAPI(), 500);
    </script>
</body>
</html>
